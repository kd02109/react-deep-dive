# Next.js ì—…ë°ì´íŠ¸ ì‚´í´ë³´ê¸°

êµì¬ì˜ Next.jsì˜ ë²„ì „ì€ 12.2.5ë¡œ í˜„ì¬ ì“°ì´ëŠ” 13, 14ë²„ì „ê³¼ ë‹¤ì†Œ ì°¨ì´ê°€ ìˆì–´, ê·¸ ì ì„ ì •ë¦¬í•´ ë³´ì•˜ìŠµë‹ˆë‹¤.

## ğŸ’ Next.js 13 ì—…ë°ì´íŠ¸

### ğŸ”¹Page Routerì™€ App Router

ê¸°ì¡´ Next.jsëŠ” /page í´ë”ì— ëª¨ë“  ì›¹ ì‚¬ì´íŠ¸ì˜ í˜ì´ì§€ ì»´í¬ë„ŒíŠ¸ë¥¼ ì²˜ë¦¬í•˜ê³¤ í–ˆë‹¤. Reactì— ë¹„í•´ ë¼ìš°íŒ… ì„¤ì •ì„ í•˜ë‚˜ë„ í•˜ì§€ ì•Šì•„ë„ íŒŒì¼ êµ¬ì¡°ë¥¼ ì´ìš©í•´ì„œ Next.jsì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì§€ì›í•˜ëŠ” ë¼ìš°íŒ…ì„ í›Œë¥­í•˜ê²Œ ì‚¬ìš©í•˜ì—¬ ê°œë°œì´ íš¨ìœ¨ì ì´ê¸°ë„ í–ˆë‹¤.

ë§Œì•½ /user í´ë” ì•„ë˜ì— change-username.tsx ë¼ëŠ” íŒŒì¼ì´ ìˆìœ¼ë©´
`http://í”„ë¡œì íŠ¸/user/change-username` ì™€ ê°™ì€ urlë¡œ ì ‘ì† ì‹œ í”„ë¡œì íŠ¸ê°€ ë¼ìš°íŒ…ë˜ì–´ ë™ì‘í•œë‹¤. ì´ëŸ¬í•œ Next.jsì—ì„œ ê¸°ë³¸ ì œê³µë˜ëŠ” ë¼ìš°í„°ë¥¼ Page Routerë¼ê³  ë¶€ë¥¸ë‹¤.

#### App Router

ê¸°ì¡´ì— pages/ ë””ë ‰í† ë¦¬ì—ì„œ ë¼ìš°íŒ… ë˜ë˜ ë°©ì‹ê³¼ ë‹¤ë¥´ê²Œ, app/ ë””ë ‰í† ë¦¬ë¡œ ë¼ìš°íŒ… í•˜ëŠ” ë°©ì‹ì´ ì¶”ê°€ë˜ì—ˆë‹¤.

- app/ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ì—¬ ë¼ìš°íŒ…ì„ ì„¤ì •í•  ìˆ˜ ìˆìœ¼ë©°, ë¼ìš°íŒ… í™˜ê²½ ê°œì„  ë¿ë§Œ ì•„ë‹ˆë¼, ë ˆì´ì•„ì›ƒ, ì„œë²„ ì»´í¬ë„ŒíŠ¸, ìŠ¤íŠ¸ë¦¬ë°, ë°ì´í„° íŒ¨ì¹­ê¹Œì§€ë„ ì§€ì›í•˜ëŠ” í˜•íƒœë¡œ í–¥ìƒë˜ì—ˆë‹¤.
  - Layout: ë¦¬ë Œë”ë§ ë°©ì§€ë¥¼ ìœ„í•œ ë ˆì´ì•„ì›ƒ ì œê³µ (ê¸°ì¡´ \_app.tsx íŒŒì¼ê³¼ ë¹„ìŠ·í•œ ê°œë…)
  - Server Component: app ë””ë ‰í† ë¦¬ ë‚´ íŒŒì¼ì€ ë””í´íŠ¸ë¡œ ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¡œ ë™ì‘í•¨
  - Streaming: app ë””ë ‰í† ë¦¬ëŠ” ë Œë”ë§ë˜ëŠ” UI ë‹¨ìœ„ë¥¼ ì ì§„ì ìœ¼ë¡œ ë Œë”ë§ & ìŠ¤íŠ¸ë¦¬ë°í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ ì œê³µ
  - Data Fetching ì§€ì›: fetch() Web APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ì–´, ì»´í¬ë„ŒíŠ¸ ë ˆë²¨ì—ì„œë„ SSR ì ìš© ê°€ëŠ¥

### ğŸ”¹Layout

> ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  Rerenderingì„ ë°©ì§€í•˜ë©´ì„œ ìì²´ ê²½ë¡œ ì•ˆì˜ ì»´í¬ë„ŒíŠ¸ì™€ UIë¥¼ ì‰½ê²Œ ê³µìœ í•  ìˆ˜ ìˆë‹¤.

App Routerì—ì„œëŠ” `https://í”„ë¡œì íŠ¸/dashboard` ë¼ìš°íŒ…ì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ `/app/dashboard/page.js` íŒŒì¼ì„ ìƒì„±í•´ì•¼ í•œë‹¤.

```js
// app/dashboard/page.js
export default function Page() {
  return <h1>Hello, Next.js!</h1>;
}
```

ì´ì œ ê°™ì€ í´ë” ë‚´ì— layout íŒŒì¼ì„ ì •ì˜í•œë‹¤. ë ˆì´ì•„ì›ƒì€ ì—¬ëŸ¬ í˜ì´ì§€ ê°„ì— UIë¥¼ ê³µìœ í•œë‹¤. ë ˆì´ì•„ì›ƒì€ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  í•´ë‹¹ í´ë” ë‚´ì—ì„œ íƒìƒ‰í• ë•Œ ë‹¤ì‹œ ë Œë”ë§ë˜ì§€ ì•ŠëŠ” ì¥ì ì´ ìˆë‹¤. ë§ˆì¹˜ ì „ì—­ ì»´í¬ë„ŒíŠ¸ë¥¼ ì •ì˜í•œ ê²ƒì²˜ëŸ¼!

```js
// app/dashboard/layout.js
export default function BlogLayout({ children }) {
  return <section>{children}</section>;
}

// ì´ ë ˆì´ì•„ì›ƒ íŒŒì¼ì€ dashboard ì•ˆì˜ ëª¨ë“  ê³³ì—ì„œ ì‚¬ìš©ë˜ë©° ë‹¤ì‹œ ë Œë”ë§ë˜ì§€ ì•ŠëŠ”ë‹¤.
```

<!--
![Alt text](image-1.png)

![Alt text](image-2.png)

app ë””ë ‰í† ë¦¬ ë£¨íŠ¸ì— ìˆëŠ” RootLayoutì€ í•„ìˆ˜ì´ë©°, ê·¸ í•˜ìœ„ì— ìˆëŠ” í´ë”ì—ì„œëŠ” ì»¤ìŠ¤í…€ ë ˆì´ì•„ì›ƒì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì´ë•Œ, ìœ„ ì‚¬ì§„ì²˜ëŸ¼ ìƒìœ„ ë ˆì´ì•„ì›ƒì´ í•˜ìœ„ ë ˆì´ì•„ì›ƒì„ ê°ì‹¸ëŠ” êµ¬ì¡°ì´ë‹¤.

```js
// app/layout.js (í•„ìˆ˜)
export default function RootLayout({ children }) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  );
}
``` -->

### ğŸ”¹Server Component

> Reactì˜ ì„œë²„ ì»´í¬ë„ŒíŠ¸ ì•„í‚¤í…ì²˜ ì§€ì›

`app directory` ë‚´ë¶€ì—ì„œëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ê°€ ê¸°ë³¸ì ìœ¼ë¡œ **ì„œë²„ ì»´í¬ë„ŒíŠ¸**ë¡œ ë™ì‘í•œë‹¤.

ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ì—ì„œ htmlì„ ë¹Œë“œí•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ëŠ”ë°, í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡ë˜ëŠ” JSì½”ë“œ ì–‘ì„ ì¤„ì´ê³ , ë³µì¡í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆì–´ ì´ˆê¸° í˜ì´ì§€ ë¡œë“œ ì†ë„ë¥¼ ë¹ ë¥´ê²Œ í•´ì¤€ë‹¤.

URLì´ ë¡œë“œë˜ë©´ Next.jsì™€ React ëŸ°íƒ€ì„ì´ ë¡œë“œëœë‹¤. ì´ë ‡ê²Œ ë˜ë©´ **ìºì‹œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê³  ëŸ°íƒ€ì„ì´ ì˜ˆì¸¡ ê°€ëŠ¥**í•˜ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì»¤ì ¸ë„ ëŸ°íƒ€ì„ í¬ê¸°ê°€ ëŠ˜ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤. ëŸ°íƒ€ì„ì´ ë¹„ë™ê¸°ë¡œ ë¡œë“œë˜ê¸° ë•Œë¬¸ì— ì„œë²„ì˜ HTMLì´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì ì§„ì ìœ¼ë¡œ í–¥ìƒë  ìˆ˜ ìˆë‹¤.

ì„œë²„ ì»´í¬ë„ŒíŠ¸ vs í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸: ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë˜ëŠ” ì¥ì†Œê°€ ì„œë²„ì¸ì§€ í´ë¼ì´ì–¸íŠ¸ì¸ì§€ì˜ ì°¨ì´. ì„œë²„ ì»´í¬ë„ŒíŠ¸ëŠ” ì„œë²„ì—ì„œ í•œ ë²ˆ í•´ì„ ëœ í›„ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬ëœë‹¤.

```js
"use client";

import { useState } from "react";

export default function Counter() {
  const [count, setCount] = useState(0);

  return (
    <div>
      <p>You clicked the Count++ button {count} times</p>
      <button onClick={() => setCount(count + 1)}>Count++</button>
    </div>
  );
}
```

ë§Œì•½ `app directory` ë‚´ë¶€ì—ì„œ í´ë¼ì´ì–¸íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ë©´ íŒŒì¼ ìµœìƒë‹¨ì— `use client`ë¼ëŠ” directiveë¥¼ ëª…ì‹œí•´ì•¼ í•œë‹¤.

- useState, useEffect í›…ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°
- íŠ¹ì • ë¸Œë¼ìš°ì € APIì— ì˜ì¡´ì„±ì´ ìˆëŠ” ê²½ìš°
- íŠ¹ì • Event Listenersë¥¼ ì¶”ê°€í•˜ëŠ” ê²½ìš°

### ğŸ”¹Streaming

> ë¡œë”© ìƒíƒœ í‘œì‹œ & ë Œë”ë§ë˜ëŠ” UI ë‹¨ìœ„ ìŠ¤íŠ¸ë¦¬ë°

dashboard ë‚´ë¶€ì— `loading.js`ë¥¼ ì¶”ê°€í•˜ë©´ ì–´ë–¤ ìœ„ì¹˜ì—ì„œ ë¡œë”©í• ë•Œ ì´ë¯¸ Next.jsì—ì„œ ë¡œë“œëœ `loading.js` íŒŒì¼ ê¸°ë°˜ì˜ ì»´í¬ë„ŒíŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ë¡œë”© ì¤‘ì„ì„ í‘œì‹œí•˜ê³ , ë°ì´í„°ê°€ ë¡œë”©ì´ ì™„ë£Œëœ ë¶€ë¶„ì„ ë¨¼ì € í‘œì‹œí•œë‹¤.

<!-- Reactì˜ Suspenseì™€ ìƒë‹¹íˆ ë¹„ìŠ·í•˜ë‹¤. -->

<!-- app/ ë””ë ‰í† ë¦¬ëŠ” UIì˜ ë Œë”ë§ ë‹¨ìœ„ë¥¼ **ì ì§„ì ìœ¼ë¡œ ë Œë”ë§**í•˜ê³  ë Œë”ë§ëœ ë‹¨ìœ„ë¥¼ í´ë¼ì´ì–¸íŠ¸ë¡œ ë¶€ë¶„ì ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

SSRë¡œ ë Œë”ë§ì„ í•˜ë©´ ë¸”ë¡œí‚¹ì´ ë  ìˆ˜ ìˆë‹¤. ì´ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ í˜ì´ì§€ì˜ HTMLì„ ì‘ì€ **ì²­í¬ë¡œ ë¶„í• **í•˜ê³ , ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì ì§„ì ìœ¼ë¡œ ì²­í¬ë¥¼ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ UIë¥¼ ë Œë”ë§í•˜ê¸° ì „ì— ëª¨ë“  ë°ì´í„°ë¥¼ ê¸°ë‹¤ë¦´ í•„ìš” ì—†ì´ í˜ì´ì§€ì˜ ì¼ë¶€ë¥¼ ë” ë¹¨ë¦¬ í‘œì‹œí•  ìˆ˜ ìˆê²Œ ëœë‹¤. -->

![Alt text](image-3.png)

```js
/* app/dashboard/loading.tsx */

export default function Loading() {
  // You can add any UI inside Loading, including a Skeleton.
  return <LoadingSkeleton />;
}
```

### ğŸ”¹Data Fetching

> ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê³  Promiseë¥¼ ì²˜ë¦¬í•˜ëŠ” ìƒˆë¡œìš´ ë°©ë²•. <br/> ê°œì„ ëœ Next.jsìš© fetch Web API (ì¤‘ë³µ ìš”ì²­ ì œê±°, ë°ì´í„° ìºì‹œ, ìœ íš¨ì„± ê²€ì¦ ë“±)ì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ SSG, SSR, ISRì˜ ëª¨ë“  ì´ì ì„ í•˜ë‚˜ì˜ APIë¡œ ì œê³µí•  ìˆ˜ ìˆë‹¤.

- fetch() Web APIë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ë˜ë©´ì„œ, ì´ì œëŠ” ì»´í¬ë„ŒíŠ¸ ë ˆë²¨ì—ì„œë„ SSRì˜ ì ìš©ì´ ê°€ëŠ¥í•´ì§„ ê²ƒ.
- ReactëŠ” fetch() APIì˜ ì¤‘ë³µì œê±°ë¥¼ ì œê³µí•˜ë©°, Next.jsëŠ” ìºì‹±ê³¼ ì¬ìš”ì²­ ì²˜ë¦¬ê¹Œì§€ ì§€ì›
- ì´ë¥¼ í†µí•´, ê¸°ì¡´ì˜ SSG, SSR, ISR(Incremental Static Regeneration) ë“±ì˜ ê¸°ë²•ì„ ì•„ë˜ì™€ ê°™ì€ fetch() ì˜µì…˜ìœ¼ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•˜ë‹¤.

```js
// This request should be cached until manually invalidated.
// Similar to `getStaticProps`.
// `force-cache` is the default and can be omitted.
fetch(URL, { cache: "force-cache" });

// This request should be refetched on every request.
// Similar to `getServerSideProps`.
fetch(URL, { cache: "no-store" });

// This request should be cached with a lifetime of 10 seconds.
// Similar to `getStaticProps` with the `revalidate` option.
fetch(URL, { next: { revalidate: 10 } });
```

```js
async function getData() {
  const res = await fetch("https://api.example.com/...");
  // The return value is *not* serialized
  // You can return Date, Map, Set, etc.
  return res.json();
}

// This is an async Server Component
export default async function Page() {
  const data = await getData();

  return <main>{/* ... */}</main>;
}
```

ë‹¨, Next.jsì—ì„œ ê¸°ë³¸ ì œê³µë˜ëŠ” fetch APIë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ë©°, ê·¸ ì™¸ì˜ ì„œë“œíŒŒí‹° api ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì‹œ ìºì‹±ì„ ë”°ë¡œ í•´ì•¼í•œë‹¤. ê¸°ì¡´ `getStaticPages` ë“± Next.jsì—ì„œ ì§€ì›í–ˆë˜ ê¸°ëŠ¥ì€ ì„œë²„ ì»´í¬ë„ŒíŠ¸ê°€ ìƒê¹€ìœ¼ë¡œ ë¬´ì˜ë¯¸í•´ì¡Œë‹¤.

## ğŸ’ Page Routerì™€ App Routerì˜ ë¹„êµ

![Alt text](image-4.png)
(ì„œë²„ êµ¬ì„±ìš”ì†Œ = ì„œë²„ ì»´í¬ë„ŒíŠ¸ë¥¼ ì˜ë¯¸)

### ğŸ”¹ëª©ì ê³¼ ìŠ¤íŠ¸ëŸ­ì²˜ì—ì„œì˜ ì°¨ì´ì 

#### ëª©ì 

- App Router: ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì „ë°˜ì ì¸ ë¼ìš°íŒ… ë° íƒìƒ‰ì„ ì²˜ë¦¬í•œë‹¤. URLì„ ê¸°ë°˜ìœ¼ë¡œ ì˜¬ë°”ë¥¸ í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ê³  í˜ì´ì§€ê°„ ì „í™˜ì„ ê´€ë¦¬í•œë‹¤.

- Page Router: ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê°œë³„ í˜ì´ì§€ ë‚´ì— ë¼ìš°íŒ…ì„ ì²˜ë¦¬í•œë‹¤. ì´ë¥¼ í†µí•´ ë™ì  ê²½ë¡œë¥¼ ë§Œë“¤ê³ , íŠ¹ì • ì½˜í…ì¸ ë¥¼ ë Œë”ë§í•˜ê¸° ìœ„í•œ ê²½ë¡œ paramaterì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.

#### ìŠ¤íŠ¸ëŸ­ì²˜

- App Router: \_app.js íŒŒì¼ì— êµ¬í˜„ë˜ì–´ ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë˜í•‘í•œë‹¤.

- Page Router: ê° ê°œë³„ í˜ì´ì§€ êµ¬ì„±ìš”ì†Œì— êµ¬í˜„ëœë‹¤.

---

#### reference

https://www.jadru.com/diffrent-approuter-and-pagerouter

https://velog.io/@khy226/Next.js-13-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8-%EB%90%9C-%EB%82%B4%EC%9A%A9-%EC%A0%95%EB%A6%AC-App-%EB%9D%BC%EC%9A%B0%ED%84%B0-%EC%9E%90%EC%84%B8%ED%9E%88-%EC%95%8C%EC%95%84%EB%B3%B4%EA%B8%B0#data-fetching
